
{% macro navbar(current) %}
<nav class="navbar navbar-toggleable-sm navbar-inverse bg-primary">
  <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class='navbar-brand'><img src='/static/images/cone.png'/> Scorekeeper Reg</div>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav">
        <li class="nav-item {{'active' if current=='profile'}}"><a class="nav-link" href="{{url_for(".profile")}}">Profile</a></li>
        <li id="seriesdropdown" class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown">{{g.series or "<no series>"}}</a>
          <div class="dropdown-menu">
          {% for s in g.activeseries %}
            {% if s != g.series %}
                <a class="dropdown-item" href="{{url_for('.events', series=s)}}">{{s}}</a>
            {% endif %}
          {% endfor %}
          </div>
        </li>
        {% if not g.series  %}
        <li class="nav-item"><a class="nav-link disabled">Cars</a></li>
        <li class="nav-item"><a class="nav-link disabled">Events</a></li>
        {% else %}
        <li class="nav-item {{'active' if current=='cars'}}"><a class="nav-link" href="{{url_for(".cars")}}">Cars</a></li>
        <li class="nav-item {{'active' if current=='events'}}"><a class="nav-link" href="{{url_for(".events")}}">Events</a></li>
        {% endif %}
        <li class="nav-item"><a class="nav-link" href="{{url_for(".logout")}}">Logout</a></li>
    </ul>
  </div>
</nav>
{% endmacro %}


{% macro formerrors(formerror) %}
{% if formerror is string: %}
<div class='formerror'>{{formerror}}</div>
{% else %}
{% for field, msg in formerror.items(): %}
<div class='formerror'>{{field}}: {{msg[0]}}</div>
{% endfor %}
{% endif %}
{% endmacro %}


{% macro modal(id, title, body) %}
<div class='modal fade' id='{{id}}' tabindex=-1 role='dialog'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>

<div class='modal-header'>
<h1 class='modal-title text-center'>{{title}}</h1>
<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
</div> {# modal-header #}

<div class='modal-body'>
<div class='container-fluid'>
<div class='modal-error'></div>
{{ body|safe }}
{{caller() if caller}}
</div> {# modal-body #}

</div> {# modal-content #}
</div> {# modal-dialog #}
</div> {# modal #}
{% endmacro %}


{% macro driverDisplay(driver) %}
{% set basic = ('address', 'city', 'state', 'zip', 'phone', 'brag', 'sponsor') %}

<div class='driverwrapper'>
<div class='name'>{{driver.firstname}} {{driver.lastname}}</div>
<div class='email'>{{driver.email}}</div>
<div class='membership'>{{driver.membership}}</div>
<div class='address'>{{driver.attr.address}}</div>
<div class='csz'>{{driver.attr.city}} {{driver.attr.state}} {{driver.attr.zip}}</div>
<div class='phone'>{{driver.attr.phone}}</div>
{% if driver.attr.brag %}
<div class='brag'>Brag: {{driver.attr.brag}}</div>
{% endif %}
{% if driver.attr.sponsor %}
<div class='dsponsor'>Sponsor: {{driver.attr.sponsor}}</div>
{% endif %}

{% for k, v in driver.attr.items(): -%}
{%- if k not in basic -%}
<div class='{{k}}'>{{v}}</div>
{%- endif -%}
{%- endfor %}
</div>

{% endmacro %}


{% macro carDisplay(car) %}
{% set istr = g.classdata.getIndexStr(car) %}
<div class='cardisplay'>
<span class='code'>{{car.classcode}}/{{car.number}} {{istr and "("+istr+")" or ""}}</span>
<span class='desc'>{{car.attr.year}} {{car.attr.make}} {{car.attr.model}} {{car.attr.color}}</span> 
</div>
{% endmacro %}


{% macro  paypalLink(event) %}
    <form class='paypalform' action='https://www.paypal.com/cgi-bin/webscr' method='post' target='_blank'>
    <span class='eimage'>
    <input type='hidden' name='cmd' value='_xclick' />
    <input type='hidden' name='business' value='{{event.paypal}}' />
    <input type='hidden' name='item_name' value='{{event.name}}' />
    <input type='hidden' name='custom' value='{{g.driver.driverid}}/{{event.eventid}}' />
    <input type='hidden' name='amount' value='{{event.cost}}' />
    <input type='hidden' name='currency_code' value='USD' />
    <input type='hidden' name='notify_url' value='{{url_for('.ipn')}}'>
    <input type='image' src='https://www.paypal.com/en_US/i/btn/x-click-but3.gif' name='submit'
                        alt='Make payments with payPal - it&#039;s fast, free and secure!' />
    </span>
    </form>
{% endmacro %}


